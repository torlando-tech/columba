---
phase: 11.5-signal-bridge-fix
plan: 01
subsystem: telephony
tags: [signalling, kotlin, python, chaquopy, audio-pipeline]

# Dependency graph
requires:
  - phase: 11-telephony-integration
    provides: Kotlin Telephone class, NetworkPacketBridge, PythonNetworkTransport
provides:
  - INTEGER signal delivery from Python LXST to Kotlin Telephone
  - Signalling constants in Python CallManager
  - Debug logging for signal flow tracing
affects: [11.6-python-audio-disable, 12-production-readiness]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Dual notification pattern: STRING events for UI + INTEGER signals for state machine"

key-files:
  created: []
  modified:
    - python/lxst_modules/call_manager.py
    - reticulum/src/main/java/com/lxmf/messenger/reticulum/audio/bridge/NetworkPacketBridge.kt

key-decisions:
  - "Send CONNECTING before ESTABLISHED for pipeline initialization sequence"
  - "Send STATUS_AVAILABLE on call ended to indicate ready for new calls"
  - "Debug logging acceptable in signal path (infrequent state transitions)"

patterns-established:
  - "Python callback handlers call both _notify_kotlin() and send_signal()"

# Metrics
duration: 5min
completed: 2026-02-05
---

# Phase 11.5 Plan 01: Wire Integer Signals from Python to Kotlin Summary

**INTEGER signal wiring from Python LXST callbacks to Kotlin Telephone via send_signal() - fixes Gap 1 critical blocker**

## Performance

- **Duration:** 5 min
- **Started:** 2026-02-05T18:15:15Z
- **Completed:** 2026-02-05T18:20:00Z
- **Tasks:** 4 (combined into 2 commits)
- **Files modified:** 2

## Accomplishments

- Added STATUS_* signalling constants (0x00-0x06) to Python CallManager
- Wired all LXST callback handlers to send INTEGER signals via send_signal()
- Added debug logging in NetworkPacketBridge for signal flow tracing
- Preserved existing STRING event notifications for UI compatibility

## Task Commits

Each task was committed atomically:

1. **Tasks 1-3: Python signal wiring** - `0926844a` (feat)
   - Added signalling constants
   - Added send_signal() calls to all callback handlers
   - Added CONNECTING signal before ESTABLISHED for pipeline init
2. **Task 4: Kotlin debug logging** - `d94fbaf7` (feat)
   - Added Log.d() in onPythonSignalReceived()

## Files Created/Modified

- `python/lxst_modules/call_manager.py` - Added STATUS_* constants and send_signal() calls in all LXST callbacks
- `reticulum/src/main/java/com/lxmf/messenger/reticulum/audio/bridge/NetworkPacketBridge.kt` - Added debug logging in signal handler

## Decisions Made

- **CONNECTING before ESTABLISHED:** Send STATUS_CONNECTING (0x05) before STATUS_ESTABLISHED (0x06) in _handle_established() to allow Kotlin Telephone to open pipelines before starting audio flow
- **STATUS_AVAILABLE on ended:** Send STATUS_AVAILABLE (0x03) when call ends to indicate ready state for new calls
- **Signal logging acceptable:** Unlike packet path (hot, continuous), signal path is infrequent (state transitions only), so Log.d() is acceptable for debugging

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- INTEGER signals now flow from Python to Kotlin Telephone state machine
- Kotlin Telephone should receive RINGING/CONNECTING/ESTABLISHED signals and open audio pipelines
- Ready for Phase 11.6: Python Audio Disable to prevent duplicate audio processing

**Remaining gap to verify:**
- Signal callback registration in Kotlin Telephone (must call networkPacketBridge.setSignalCallback())
- End-to-end call test to confirm pipelines open on ESTABLISHED

---
*Phase: 11.5-signal-bridge-fix*
*Completed: 2026-02-05*
